<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Simple client-side salary tracker app to manage monthly income, expenses, and balances in EUR with BGN conversion.">
  <meta name="keywords" content="salary tracker, expense tracker, budget app, personal finance, monthly budget, income expense manager">
  <meta name="robots" content="noindex, nofollow">
  <meta property="og:title" content="Salary Tracker">
  <meta property="og:description" content="Track your salary, income, and expenses monthly with carry-over balances.">
  <meta property="og:type" content="website">
  <title>Salary Tracker</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root {
      --bg: #0d0d18;
      --surface: #161622;
      --text: #e2e8f0;
      --text2: #94a3b8;
      --primary: #60a5fa;
      --income: #34d399;
      --income-rgb: 52, 211, 153;
      --expense: #f87171;
      --expense-rgb: 248, 113, 113;
      --border: #2a2f45;
      --radius: 10px;
      --edit: #60a5fa;
      --delete: #f87171;
      --income-bg: rgba(52, 211, 153, 0.1);
      --expense-bg: rgba(248, 113, 113, 0.1);
    }
    [data-theme="light"] {
      --bg: #e5e7eb;
      --surface: #f3f4f6;
      --text: #111827;
      --text2: #4b5563;
      --primary: #3b82f6;
      --income: #10b981;
      --income-rgb: 16, 185, 129;
      --expense: #ef4444;
      --expense-rgb: 239, 68, 68;
      --border: #d1d5db;
      --edit: #3b82f6;
      --delete: #ef4444;
      --income-bg: rgba(16, 185, 129, 0.1);
      --expense-bg: rgba(239, 68, 68, 0.1);
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 12px;
      overflow-y: auto;
    }
    .container { max-width: 720px; margin: 0 auto; }
    .theme-wrapper {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 8px;
    }
    .theme-toggle {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
      cursor: pointer;
      font-size: 0.9rem;
      width: 32px;
      height: 32px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s, transform 0.1s;
    }
    .theme-toggle:hover {
      background: var(--primary);
      color: white;
      transform: scale(1.05);
    }
    header {
      margin-bottom: 1.2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    h1 { font-size: 1.6rem; font-weight: 600; }
    .subtitle { color: var(--text2); font-size: 0.9rem; }
    .form {
      background: var(--surface);
      padding: 12px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 1.4rem;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    input, select, button {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #1c1f32;
      color: var(--text);
      font-size: 14px;
      min-height: 36px;
      line-height: 1.2;
    }
    [data-theme="light"] input, [data-theme="light"] select, [data-theme="light"] button {
      background: #ffffff;
    }
    input:focus, select:focus { outline: none; }
    input[type=number] {
      width: 100px;
      appearance: textfield;
      -moz-appearance: textfield;
    }
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[placeholder] { color: var(--text2); }
    select { min-width: 90px; }
    select option {
      background: var(--surface);
      color: var(--text);
    }
    button {
      background: var(--primary);
      border: none;
      color: white;
      font-weight: 600;
      cursor: pointer;
      min-width: 70px;
    }
    .income-select { background: var(--income-bg); border-color: var(--income); }
    .expense-select { background: var(--expense-bg); border-color: var(--expense); }
    .desc-field { flex: 3 1 180px; }
    .amount-field { flex: 1 1 100px; }
    .type-field { flex: 1 1 90px; }
    .month {
      background: var(--surface);
      border-radius: var(--radius);
      margin-bottom: 1.2rem;
      border: 1px solid var(--border);
      overflow: hidden;
    }
    .month-header {
      padding: 10px 14px;
      background: #1e2238;
      display: flex;
      justify-content: space-between;
      font-weight: 600;
      font-size: 1.05rem;
      border-bottom: 1px solid var(--border);
    }
    [data-theme="light"] .month-header { background: #e5e7eb; }
    .month-balance { font-variant-numeric: tabular-nums; }
    .positive { color: var(--income); }
    .negative { color: var(--expense); }
    .month-total {
      text-align: center;
      padding: 10px;
      font-size: 1.2rem;
      font-weight: bold;
      border-bottom: 1px solid var(--border);
    }
    .transactions-list {
      max-height: 150px;
      overflow-y: auto;
    }
    .transactions-list::-webkit-scrollbar { width: 5px; }
    .transactions-list::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    [data-theme="light"] .transactions-list::-webkit-scrollbar-thumb { background: #a1a1aa; }
    .row {
      padding: 8px 14px;
      border-top: 1px solid var(--border);
      display: grid;
      gap: 4px 10px;
      grid-template-columns: 1fr 220px 100px;
      align-items: center;
    }
    .desc { font-size: 0.95rem; line-height: 1.3; }
    .meta { font-size: 0.74rem; color: var(--text2); }
    .amt { text-align: right; font-weight: 500; }
    .income { color: var(--income); }
    .expense { color: var(--expense); }
    .bgn { font-size: 0.78rem; color: var(--text2); text-align: right; }
    .actions { display: flex; gap: 6px; justify-content: flex-end; align-self: end; }
    .btn-small {
      background: transparent;
      border: 1px solid #444;
      width: 32px;
      height: 32px;
      border-radius: 6px;
      color: inherit;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    [data-theme="light"] .btn-small { border-color: #ccc; }
    .btn-edit { border-color: var(--edit); color: var(--edit); }
    .btn-delete { border-color: var(--delete); color: var(--delete); }
    .btn-edit:hover { background: rgba(96,165,250,0.2); }
    .btn-delete:hover { background: rgba(248,113,113,0.2); }
    .empty-month { padding: 16px; color: var(--text2); text-align: center; font-style: italic; font-size: 0.9rem; }
    @media (max-width: 560px) {
      body { padding: 10px; }
      .form { padding: 12px; flex-direction: column; gap: 8px; }
      input, select, button { width: 100%; max-height: 44px; font-size: 16px; padding: 0px 12px; }
      .row {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto;
        gap: 6px;
        padding: 10px 12px;
      }
      .actions { justify-content: flex-end; gap: 12px; }
      .btn-small { width: 40px; height: 40px; font-size: 1rem; }
      .amt, .bgn { text-align: left; }
    }
  </style>
</head>
<body data-theme="dark">
<div class="container">
  <div class="theme-wrapper">
    <button class="theme-toggle" id="theme-toggle"><i class="fa-solid fa-moon"></i></button>
  </div>
  <header>
    <h1>Salary Tracker</h1>
  </header>
  <div class="form">
    <input id="desc" class="desc-field" placeholder="Description">
    <input id="amount" class="amount-field" type="number" step="0.01" min="0.01" placeholder="Amount" inputmode="decimal">
    <select id="type" class="type-field">
      <option value="income">Income</option>
      <option value="expense">Expense</option>
    </select>
    <button id="add">Add</button>
  </div>
  <div id="months"></div>
</div>
<script>
const STORAGE_KEY = 'salary-tracker-monthly-v3';
const THEME_KEY = 'salary-tracker-theme';
const EUR_TO_BGN = 1.95583;
let months = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
let editing = null;
function getMonthKey(d = new Date()) {
  return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0');
}
function getOrCreateMonth(key) {
  if (!months[key]) {
    let carry = 0;
    const [y,m] = key.split('-').map(Number);
    let py=y, pm=m-1; if(pm===0){pm=12;py--;}
    const pk = `${py}-${String(pm).padStart(2,'0')}`;
    if(months[pk]) carry = months[pk].carry + months[pk].income - months[pk].expense;
    months[key] = {income:0, expense:0, carry, tx:[]};
  }
  return months[key];
}
function save() { localStorage.setItem(STORAGE_KEY, JSON.stringify(months)); }
function render() {
  const c = document.getElementById('months');
  c.innerHTML = '';
  const keys = Object.keys(months).sort().reverse();
  const ck = getMonthKey();
  if(!keys.includes(ck)){ getOrCreateMonth(ck); keys.unshift(ck); }
  keys.forEach(key => {
    const m = months[key];
    const final = m.carry + m.income - m.expense;
    const isCur = key === ck;
    const mo = document.createElement('div'); mo.className='month';
    const h = document.createElement('div'); h.className='month-header';
    h.innerHTML = `<div>${key}${isCur?' <small>(current)</small>':''}</div>`;
    const totalDiv = document.createElement('div'); totalDiv.className='month-total';
    totalDiv.innerHTML = `<span class="month-balance ${final>=0?'positive':'negative'}">${final.toFixed(2)} €</span>`;
    const l = document.createElement('div');
    l.className = 'transactions-list';
    if (m.carry !== 0) {
      const cr = document.createElement('div'); cr.className='row';
      cr.innerHTML = `<div class="desc" style="color:var(--text2)">Carry from prev</div>
        <div class="amt">${m.carry>=0?'+':''}${m.carry.toFixed(2)} €</div><div></div>`;
      l.appendChild(cr);
    }
    if (m.tx.length === 0 && m.carry === 0) {
      const e = document.createElement('div'); e.className='empty-month';
      e.textContent = 'No transactions this month';
      l.appendChild(e);
    } else {
      m.tx.forEach((t,i) => {
        const r = document.createElement('div'); r.className='row';
        const dateStr = new Date(t.ts).toLocaleString('bg-BG', {
          day: '2-digit', month: '2-digit', year: 'numeric',
          hour: '2-digit', minute: '2-digit', hour12: false
        }).replace(',', '');
        const bgnAmt = (t.amt * EUR_TO_BGN).toFixed(2);
        r.innerHTML = `
          <div>
            <div class="desc">${t.desc}</div>
            <div class="meta">${dateStr}</div>
          </div>
          <div>
            <div class="amt ${t.type}">${t.type==='income'?'+':'-'}${Number(t.amt).toFixed(2)} €</div>
            <div class="bgn">≈ ${bgnAmt} BGN</div>
          </div>
          <div class="actions">
            <button class="btn-small btn-edit" onclick="startEdit('${key}',${i})"><i class="fa-solid fa-pencil"></i></button>
            <button class="btn-small btn-delete" onclick="removeTx('${key}',${i})"><i class="fa-solid fa-trash"></i></button>
          </div>`;
        l.appendChild(r);
      });
    }
    mo.appendChild(h); mo.appendChild(totalDiv); mo.appendChild(l); c.appendChild(mo);
  });
  document.getElementById('add').textContent = editing ? 'Save Edit' : 'Add';
}
function startEdit(monthKey, idx) {
  const t = months[monthKey].tx[idx];
  document.getElementById('desc').value = t.desc;
  document.getElementById('amount').value = t.amt;
  document.getElementById('type').value = t.type;
  const typeSelect = document.getElementById('type');
  typeSelect.classList.remove('income-select', 'expense-select');
  typeSelect.classList.add(`${t.type}-select`);
  editing = {monthKey, idx};
  render();
}
function addTx() {
  const desc = document.getElementById('desc').value.trim();
  const amt = Number(document.getElementById('amount').value);
  const type = document.getElementById('type').value;
  if (!desc || isNaN(amt) || amt <= 0) return;
  const key = getMonthKey();
  const m = getOrCreateMonth(key);
  if (editing) {
    const old = months[editing.monthKey].tx[editing.idx];
    if (old.type === 'income') months[editing.monthKey].income -= old.amt;
    else months[editing.monthKey].expense -= old.amt;
    months[editing.monthKey].tx[editing.idx] = {desc, amt, type, ts: Date.now()};
    if (type === 'income') months[editing.monthKey].income += amt;
    else months[editing.monthKey].expense += amt;
    editing = null;
  } else {
    m.tx.unshift({desc, amt, type, ts: Date.now()});
    if (type === 'income') m.income += amt;
    else m.expense += amt;
  }
  save();
  document.getElementById('desc').value = '';
  document.getElementById('amount').value = '';
  document.getElementById('type').value = 'income';
  const typeSelect = document.getElementById('type');
  typeSelect.classList.remove('income-select', 'expense-select');
  typeSelect.classList.add('income-select');
  render();
}
function removeTx(k, i){
  if(!confirm('Delete?')) return;
  const m = months[k];
  const t = m.tx[i];
  if(t.type==='income') m.income -= t.amt; else m.expense -= t.amt;
  m.tx.splice(i,1);
  save();
  render();
}
document.getElementById('add').onclick = addTx;
document.getElementById('amount').onkeydown = e => { if(e.key==='Enter') addTx(); };
document.addEventListener('keydown', e => {
  if (e.key === 'Escape' && editing) {
    editing = null;
    document.getElementById('desc').value = '';
    document.getElementById('amount').value = '';
    document.getElementById('type').value = 'income';
    const typeSelect = document.getElementById('type');
    typeSelect.classList.remove('income-select', 'expense-select');
    typeSelect.classList.add('income-select');
    render();
  }
});
const themeToggle = document.getElementById('theme-toggle');
const body = document.body;
const currentTheme = localStorage.getItem(THEME_KEY) || 'dark';
body.setAttribute('data-theme', currentTheme);
themeToggle.innerHTML = currentTheme === 'dark' ? '<i class="fa-solid fa-moon"></i>' : '<i class="fa-solid fa-sun"></i>';
themeToggle.onclick = () => {
  const newTheme = body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
  body.setAttribute('data-theme', newTheme);
  localStorage.setItem(THEME_KEY, newTheme);
  themeToggle.innerHTML = newTheme === 'dark' ? '<i class="fa-solid fa-moon"></i>' : '<i class="fa-solid fa-sun"></i>';
};
const typeSelect = document.getElementById('type');
typeSelect.classList.add('income-select');
typeSelect.addEventListener('change', () => {
  typeSelect.classList.remove('income-select', 'expense-select');
  typeSelect.classList.add(`${typeSelect.value}-select`);
});
render();
</script>
</body>
</html>
